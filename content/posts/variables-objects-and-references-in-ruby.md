---
title: "Variables, objects, and references in Ruby"
date: 2019-08-24T21:22:20+07:00
draft: false
summary: "อ่านหนังสือ The well-grounded rubyist และเจอหัวข้อที่น่าสนใจเกี่ยวกับการกำหนดตัวแปรในภาษา Ruby เลยมาสรุปและเล่าให้ฟังพร้อมภาพประกอบค่ะ"
---

วันนี้นั่งอ่านหนังสือ The well-grounded rubyist ของ David A.Black and Joseph Leo เจอหัวข้อที่น่าสนใจที่จะมาแชร์ให้ฟัง เป็นเรื่องของการกำหนดตัวแปรในภาษา Ruby


มาเริ่มกันที่โค้ดนี้เลยค่ะ ผลลัพธ์จะได้อะไรเอ่ย

```
str = "Hello"
abc = str
str.replace("Goodbye")
puts str
puts abc
```

จะได้แบบนี้ค่ะ

```
Goodbye
Goodbye
```

เอ... ทำไมตัวแปร `abc` ถึงเปลี่ยนค่าได้ล่ะ เราเปลี่ยนค่าที่ตัวแปร `str` อย่างเดียวนี่นา

คำตอบก็คือ เวลาที่เรากำหนดค่าให้ตัวแปร มันจะ copy reference ของ object `str` ไปให้ `abc` มันจะไม่ได้ copy value ไปนั่นเอง

ถ้าทำเป็นภาพให้เข้าใจง่ายๆ ก็คือตัวแปร `str` และ `abc` มันแค่ชี้ไปที่กล่องข้อมูลอันเดียวกัน

![](/hello.png)

ทีนี้ถ้าเรามีการเปลี่ยนแปลงกล่องข้อมูลที่มีข้อความ Hello อยู่ไปเป็นค่าอื่นเช่น การเรียก method replace ผ่านตัวแปร `str`

เวลาเราแสดงค่า `abc` เราก็จะเห็นค่าเปลี่ยนไปด้วย เพราะสองตัวแปรนี้มันชี้ไปที่ object ตัวเดียวกันนั่นเอง

![](/goodbye.png)

การ pass parameter ใน Ruby ก็เช่นกัน

```
def change_string(str)
   str.replace("New string")
end

s = "Old string"
result = change_string(s)

puts result
puts s
```

จากโค้ดข้างบน method replace ทำให้ค่าที่อยู่ใน `s` ถูกเปลี่ยนไปด้วย

```
New string
New string
```

แต่ในภาษา Ruby ก็มีข้อยกเว้นว่าข้อมูลบางประเภทที่ตัวแปรจะเก็บ object ได้โดยตรง คือเราจะไม่สามารถแก้ไขข้อมูลพวกนี้ได้

- integers
- symbols
- special object (true and false)
- nil

ตัวอย่าง

```
x = 1
y = x
y = 2
puts x
puts y
```

ผลลัพธ์ที่ได้

```
1
2
```

จะเห็นว่านี่เป็นความรู้พื้นฐานที่สำคัญในการเขียนโปรแกรม และทำให้เราเข้าใจธรรมชาติของภาษานี้ได้มากขึ้น ใช้เครื่องมือต่างๆได้อย่างถูกต้องเหมาะสม และได้พึงระวังจุดที่อาจจะทำให้โปรแกรมมีบั๊กได้ค่ะ
